

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Lesson 36: Introduction to object-oriented programming &mdash; Programming Bootcamp  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../_static/togglebutton.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script src="../_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "document", "processHtmlClass": "math|output_area"}}</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Lesson 37: Algorithmic complexity" href="l37_algorithmic_complexity.html" />
    <link rel="prev" title="Lesson 35: Regular expressions" href="l35_regular_expressions.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #F1F2D8" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Lessons</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="l00_configuring_your_computer.html">Lesson 0: Configuring your computer</a></li>
<li class="toctree-l1"><a class="reference internal" href="l01_welcome.html">Lesson 1: Welcome and Introduction to JupyterLab</a></li>
<li class="toctree-l1"><a class="reference internal" href="l02_basic_command_line_skills.html">Lesson 2: Basic command line skills</a></li>
<li class="toctree-l1"><a class="reference internal" href="l03_variables_operators_types.html">Lesson 3: Variables, operators, and types</a></li>
<li class="toctree-l1"><a class="reference internal" href="l04_more_operators_and_conditionals.html">Lesson 4: More operators and conditionals</a></li>
<li class="toctree-l1"><a class="reference internal" href="l05_lists_and_tuples.html">Lesson 5: Lists and tuples</a></li>
<li class="toctree-l1"><a class="reference internal" href="l06_iteration.html">Lesson 6: Iteration</a></li>
<li class="toctree-l1"><a class="reference internal" href="l07_intro_to_functions.html">Lesson 7: Introduction to functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="l08_string_methods.html">Lesson 8: String methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="l09_dictionaries.html">Lesson 9: Dictionaries</a></li>
<li class="toctree-l1"><a class="reference internal" href="l10_packages_and_modules.html">Lesson 10: Packages and modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="l11_file_io.html">Lesson 11: File I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="l12_version_control_with_git.html">Lesson 12: Version control with Git</a></li>
<li class="toctree-l1"><a class="reference internal" href="l13_exceptions_and_error_handling.html">Lesson 13: Errors and Exception handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="l16_style.html">Lesson 16: Style</a></li>
<li class="toctree-l1"><a class="reference internal" href="l17_intro_to_pandas.html">Lesson 17: Introduction to Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="l18_split_apply_combine.html">Lesson 18: Tidy data and split-apply-combine</a></li>
<li class="toctree-l1"><a class="reference internal" href="l19_plotting.html">Lesson 19: Making plots</a></li>
<li class="toctree-l1"><a class="reference internal" href="l20_high_level_plotting.html">Lesson 20: High level plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="l21_intro_to_numpy_and_scipy.html">Lesson 21: Introduction to Numpy and Scipy</a></li>
<li class="toctree-l1"><a class="reference internal" href="l22_plotting_time_series_generated_data.html">Lesson 22: Plotting time series and generated data</a></li>
<li class="toctree-l1"><a class="reference internal" href="l23_random_number_generation.html">Lesson 23: Random number generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="l24_comprehensions.html">Lesson 24: Comprehensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="l25_hackerstats_1.html">Lesson 25: Hacker stats I</a></li>
<li class="toctree-l1"><a class="reference internal" href="l26_hackerstats_2.html">Lesson 26: Hacker stats II</a></li>
<li class="toctree-l1"><a class="reference internal" href="l27_holoviews.html">Lesson 27: High level plotting with HoloViews</a></li>
<li class="toctree-l1"><a class="reference internal" href="l28_overplotting.html">Lesson 28: Dealing with overplotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="l38_intro_to_image_processing.html">Lesson 38: Introduction to image processing with scikit-image</a></li>
<li class="toctree-l1"><a class="reference internal" href="l39_segmentation.html">Lesson 39: Basic image quantification</a></li>
<li class="toctree-l1"><a class="reference internal" href="l32_other_packages_and_languages.html">Lesson 32: Survey of other packages and languages</a></li>
<li class="toctree-l1"><a class="reference internal" href="l33_bootcamp_recap.html">Lesson 33: Bootcamp recap</a></li>
</ul>
<p class="caption"><span class="caption-text">Auxiliary lessons</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="l30_javascript_for_bokeh.html">Lesson 30: JavaScript for stand-alone Bokeh apps</a></li>
<li class="toctree-l1"><a class="reference internal" href="l31_intro_to_scripting.html">Lesson 31: Introduction to scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="l34_more_command_line.html">Lesson 34: More about the command line</a></li>
<li class="toctree-l1"><a class="reference internal" href="l35_regular_expressions.html">Lesson 35: Regular expressions</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Lesson 36: Introduction to object-oriented programming</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Classes">Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Example:-Biological-sequences">Example: Biological sequences</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Subclasses-and-inheritence">Subclasses and inheritence</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Another-T_m-calculator">Another <span class="math notranslate nohighlight">\(T_m\)</span> calculator</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Primer-design">Primer design</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Protein-sequences">Protein sequences</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Computing-environment">Computing environment</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="l37_algorithmic_complexity.html">Lesson 37: Algorithmic complexity</a></li>
<li class="toctree-l1"><a class="reference internal" href="l40_serial.html">Lesson 40: Control of external devices</a></li>
<li class="toctree-l1"><a class="reference internal" href="l41_serial_apps.html">Lesson 41. Apps for controlling external devices</a></li>
<li class="toctree-l1"><a class="reference internal" href="l42_control_panels.html">Lesson 42: Control panels</a></li>
<li class="toctree-l1"><a class="reference internal" href="l14_testing_and_tdd.html">Lesson 14: Testing and test-driven development</a></li>
<li class="toctree-l1"><a class="reference internal" href="l15_examples_of_tdd.html">Lesson 15: Examples of TDD</a></li>
<li class="toctree-l1"><a class="reference internal" href="l29_dashboards.html">Lesson 29: Dashboards</a></li>
</ul>
<p class="caption"><span class="caption-text">Exercises</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../exercises/exercise_1/index.html">Exercise 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/exercise_2/index.html">Exercise 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/exercise_3/index.html">Exercise 3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/exercise_4/index.html">Exercise 4</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/exercise_5/index.html">Exercise 5</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/exercise_6/index.html">Exercise 6</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/exercise_7/index.html">Exercise 7</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/exercise_8/index.html">Exercise 8</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/exercise_9/index.html">Exercise 9</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/exercise_10/index.html">Exercise 10</a></li>
</ul>
<p class="caption"><span class="caption-text">Exercise solutions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../exercise_solutions/exercise_1/index.html">Exercise 1 solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercise_solutions/exercise_2/index.html">Exercise 2 solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercise_solutions/exercise_3/index.html">Exercise 3 solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercise_solutions/exercise_4/index.html">Exercise 4 solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercise_solutions/exercise_5/index.html">Exercise 5 solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercise_solutions/exercise_6/index.html">Exercise 6 solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercise_solutions/exercise_7/index.html">Exercise 7 solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercise_solutions/exercise_8/index.html">Exercise 8 solutions</a></li>
</ul>
<p class="caption"><span class="caption-text">Schedule</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../schedule.html">Schedule overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../schedule.html#daily-schedule">Daily schedule</a></li>
</ul>
<p class="caption"><span class="caption-text">Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../resources.html">Scientific Python distribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources.html#online-instruction">Online instruction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources.html#books">Books</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources.html#griffin-chure-s-templates-for-reproducible-publishing">Griffin Chure’s templates for reproducible publishing</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Programming Bootcamp</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Lesson 36: Introduction to object-oriented programming</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/lessons/l36_intro_to_oop.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Lesson-36:-Introduction-to-object-oriented-programming">
<h1>Lesson 36: Introduction to object-oriented programming<a class="headerlink" href="#Lesson-36:-Introduction-to-object-oriented-programming" title="Permalink to this headline">¶</a></h1>
<hr><p>We have spent much of the bootcamp discussing how to make code function, readable, and testable. We have used functions to help to avoid duplicated code. <strong>Object-oriented programming</strong> (OOP) goes further in that it</p>
<ul class="simple">
<li><p>keeps code organized</p></li>
<li><p>further increases readability</p></li>
<li><p>makes chunks of code portable</p></li>
</ul>
<div class="section" id="Classes">
<h2>Classes<a class="headerlink" href="#Classes" title="Permalink to this headline">¶</a></h2>
<p>Classes form the core of Python’s OOP. They are devices that create new objects. This is called <strong>instantiation</strong>. I.e., an object is an <strong>instance</strong> of a class. These objects have three characteristics which makes the use of classes particularly attractive:</p>
<ul class="simple">
<li><p><strong>multiple instances</strong>: You can have more then one instance of a given type of class. As an example, you code might have three or four different integers. These are instances of a built-in class.</p></li>
<li><p><strong>inheritance</strong>: An object can be a class of its own, it inherits all the properties of the parent class.</p></li>
<li><p><strong>operator overloading</strong>: This allows an operator to have a different meaning according to context. For example, the <code class="docutils literal notranslate"><span class="pre">+</span></code> operator has a different meaning for <code class="docutils literal notranslate"><span class="pre">floats</span></code> vs. strings.</p></li>
</ul>
<p>This is all a bit theoretical, so let’s look at an example.</p>
</div>
<div class="section" id="Example:-Biological-sequences">
<h2>Example: Biological sequences<a class="headerlink" href="#Example:-Biological-sequences" title="Permalink to this headline">¶</a></h2>
<p>In this example, we will make a class for biological sequences. The goal here is just to lift the covers off how classes are built, so you have a basic understanding what you are doing when you use the dot notation on objects.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">class</span> <span class="nc">Biosequence</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Biological sequence class with methods.&quot;&quot;&quot;</span>

    <span class="c1"># The special method __init__() is run when the class is instantiated</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seq</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="s2">&quot;dna&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instantiate Biosequence object with sequence and material.</span>

<span class="sd">        Material is either &#39;dna&#39;, &#39;rna&#39;, or &#39;protein&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seq</span> <span class="o">=</span> <span class="n">seq</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">material</span> <span class="o">=</span> <span class="n">material</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>


    <span class="c1"># Define a method</span>
    <span class="k">def</span> <span class="nf">seq_len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The length of the sequence.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p><strong>Methods</strong> are functions contained within a class. In contrast to functions they need to include the term <code class="docutils literal notranslate"><span class="pre">self</span></code> within the parentheses. Because when Python calls a method the current object becomes the first argument of the method. Using the word <code class="docutils literal notranslate"><span class="pre">self</span></code> is a convention; theoretically any other word could be used.</p>
<p>The method we have written for the <code class="docutils literal notranslate"><span class="pre">Biosequence</span></code> class is trivial, but it demonstrates the concept.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Instantiate Biosequence</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">Biosequence</span><span class="p">(</span><span class="n">seq</span><span class="o">=</span><span class="s1">&#39;ATGAAGGGTCC&#39;</span><span class="p">)</span>

<span class="c1"># Call the methods</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The sequence has&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">seq_len</span><span class="p">(),</span> <span class="s1">&#39;bases.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The sequence has 11 bases.
</pre></div></div>
</div>
<p>In addition to methods, an object also has <strong>attributes</strong>, which are values associated with it. This class has two attributes, <code class="docutils literal notranslate"><span class="pre">seq</span></code> and <code class="docutils literal notranslate"><span class="pre">material</span></code>, and has two methods, <code class="docutils literal notranslate"><span class="pre">seq_len()</span></code> and the special method <code class="docutils literal notranslate"><span class="pre">__init__()</span></code>.</p>
<div class="section" id="Subclasses-and-inheritence">
<h3>Subclasses and inheritence<a class="headerlink" href="#Subclasses-and-inheritence" title="Permalink to this headline">¶</a></h3>
<p>Let’s create a subclass <code class="docutils literal notranslate"><span class="pre">Nucleotides</span></code>. To make it inherit all of the defined methods and attributes of <code class="docutils literal notranslate"><span class="pre">Biosequence</span></code> (its parent class), we refer to <code class="docutils literal notranslate"><span class="pre">Biosequence</span></code> in the <code class="docutils literal notranslate"><span class="pre">class</span></code> definition. We will write a single method that uses the Marmur rule of thumb for computing the melting temperature of a stretch of double-stranded DNA,</p>
<p><span class="math">\begin{align}
T_m = 2\,^\circ C \, (N_A + N_T) + 4\,^\circ C \, (N_G + N_C),
\end{align}</span></p>
<p>where <span class="math notranslate nohighlight">\(N_i\)</span> denotes the number of times nucleotide <span class="math notranslate nohighlight">\(i\)</span> appears in the sequence. Remember, the class inherits all of the methods from its parent (in this case, <code class="docutils literal notranslate"><span class="pre">__init__()</span></code> and <code class="docutils literal notranslate"><span class="pre">seq_len()</span></code>), so we only need to write methods specific to nucleic acids. This is part of the <strong>don’t repeat yourself</strong> (DRY) principle.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">class</span> <span class="nc">Nucleotides</span><span class="p">(</span><span class="n">Biosequence</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Nucleotide sequences and related methods.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">T_marmur</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Melting temperature by Marmur rule of thumb.&quot;&quot;&quot;</span>
        <span class="n">seq_up</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>

        <span class="n">at_count</span> <span class="o">=</span> <span class="n">seq_up</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">seq_up</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">)</span>
        <span class="n">gc_count</span> <span class="o">=</span> <span class="n">seq_up</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;G&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">seq_up</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">at_count</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">gc_count</span>
</pre></div>
</div>
</div>
<p>So, we now have a new class for nucleotides that inherited all of the methods and attributes of its parent, <code class="docutils literal notranslate"><span class="pre">Biosequence</span></code>. It also has the new melting temperature method. Let’s put it to use.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Instantiate object</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">Nucleotides</span><span class="p">(</span><span class="s1">&#39;AAAGGTTTTTTTTTTTC&#39;</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="s1">&#39;dna&#39;</span><span class="p">)</span>

<span class="c1"># Compute result</span>
<span class="n">s</span><span class="o">.</span><span class="n">T_marmur</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
40
</pre></div></div>
</div>
<p>Let’s try it with another sequence.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">s</span> <span class="o">=</span> <span class="n">Nucleotides</span><span class="p">(</span><span class="s1">&#39;aaattg&#39;</span><span class="p">)</span>
<span class="n">s</span><span class="o">.</span><span class="n">T_marmur</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
14
</pre></div></div>
</div>
</div>
<div class="section" id="Another-T_m-calculator">
<h3>Another <span class="math notranslate nohighlight">\(T_m\)</span> calculator<a class="headerlink" href="#Another-T_m-calculator" title="Permalink to this headline">¶</a></h3>
<p>Let’s add the Wallace rule of thumb for melting temperature in degrees Celsius.</p>
<p><span class="math">\begin{align}
T_m = 64.9 + 41\,\frac{N_G + N_C - 16.4}{N_A + N_T + N_G + N_C}.
\end{align}</span></p>
<p>This, of course, works only for sequences that have some reasonable GC content. Clearly, a poly-AT sequence should not melt below freezing.</p>
<p>Since both methods require calculation of GC count, we should write a method to compute GC content so we do not repeat ourselves.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">class</span> <span class="nc">Nucleotides</span><span class="p">(</span><span class="n">Biosequence</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Nucleotide sequences and related methods.&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">gc_count</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">seq_up</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">seq_up</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;G&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">seq_up</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">at_count</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">seq_up</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">seq_up</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">seq_up</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">T_marmur</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Melting temperature by Marmur rule of thumb.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">at_count</span><span class="p">()</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">gc_count</span><span class="p">()</span>


    <span class="k">def</span> <span class="nf">T_wallace</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Melting temperature by Wallace rule of thumb.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mf">64.9</span> <span class="o">+</span> <span class="mi">41</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gc_count</span><span class="p">()</span> <span class="o">-</span> <span class="mf">16.4</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq_len</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Now let’s compare the two melting temperatures.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Instatiate class</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">Nucleotides</span><span class="p">(</span><span class="s1">&#39;GGGTTTCCCTACA&#39;</span><span class="p">)</span>

<span class="c1"># Compute melting temperatures</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;T_m via Marmur rule:&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">T_marmur</span><span class="p">(),</span> <span class="s1">&#39;°C&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;T_m via Wallace rule:&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">T_wallace</span><span class="p">(),</span> <span class="s1">&#39;°C&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
T_m via Marmur rule: 40 °C
T_m via Wallace rule: 35.25384615384617 °C
</pre></div></div>
</div>
</div>
<div class="section" id="Primer-design">
<h3>Primer design<a class="headerlink" href="#Primer-design" title="Permalink to this headline">¶</a></h3>
<p>Now that we can calculate melting temperatures, we can introduce a class that deals with primer design. It inherits the <code class="docutils literal notranslate"><span class="pre">Nucleotides</span></code> class, and then has methods to choose a primer.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">class</span> <span class="nc">Primer</span><span class="p">(</span><span class="n">Nucleotides</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Primer design.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">marmur_primer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tm</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Primer design based on Marmur rule of thumb for melting</span>
<span class="sd">        temperature.</span>

<span class="sd">        `Tm`: the desired melting temperature in deg. C of the</span>
<span class="sd">              primer-template duplex.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Start with a short primer of 10 nucleotides</span>
        <span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>

        <span class="c1"># Start at 5&#39; end with forward primer</span>
        <span class="n">forward_p</span> <span class="o">=</span> <span class="n">Nucleotides</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="p">[:</span><span class="n">n</span><span class="p">])</span>

        <span class="c1"># Keep adding based to the primer until we hit the desired Tm</span>
        <span class="k">while</span> <span class="n">forward_p</span><span class="o">.</span><span class="n">T_marmur</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">Tm</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="p">):</span>
            <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">forward_p</span><span class="o">.</span><span class="n">seq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="p">[:</span><span class="n">n</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">forward_p</span><span class="o">.</span><span class="n">seq</span>
</pre></div>
</div>
</div>
<p>Let’s try to design a primer for a sequence. We’ll take our melting temperature to be 42°C, or course.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Instantiate object with template sequence</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">Primer</span><span class="p">(</span><span class="s1">&#39;AACCCCCCAAATTTTTTTTTTGAAAAAAAAAACATATTCTTCTCTCGGGGGGGGG&#39;</span><span class="p">)</span>

<span class="n">s</span><span class="o">.</span><span class="n">marmur_primer</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;AACCCCCCAAATTTT&#39;
</pre></div></div>
</div>
<p>We would also like to compute a reverse primer. To do this, we need to be able to compute the reverse complement of a sequence. We have already done that in the last exercise, so we add that functionality to the <code class="docutils literal notranslate"><span class="pre">Nucleotides</span></code> class. Remember that since the method is aware of <code class="docutils literal notranslate"><span class="pre">self</span></code>, and the object has a <code class="docutils literal notranslate"><span class="pre">seq</span></code> attribute, we do not need to pass the <code class="docutils literal notranslate"><span class="pre">seq</span></code> argument into the function that computes the reverse complement.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">class</span> <span class="nc">Nucleotides</span><span class="p">(</span><span class="n">Biosequence</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Nucleotide sequences and related methods.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">gc_count</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">seq_up</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">seq_up</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;G&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">seq_up</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">at_count</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">seq_up</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">seq_up</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">seq_up</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">T_marmur</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Melting temperature by Marmur rule of thumb.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">at_count</span><span class="p">()</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">gc_count</span><span class="p">()</span>


    <span class="k">def</span> <span class="nf">T_wallace</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Melting temperature by Wallace rule of thumb.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mf">64.9</span> <span class="o">+</span> <span class="mi">41</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gc_count</span><span class="p">()</span> <span class="o">-</span> <span class="mf">16.4</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq_len</span><span class="p">()</span>


    <span class="k">def</span> <span class="nf">reverse_complement</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compute reverse complement of the sequence.&quot;&quot;&quot;</span>
        <span class="c1"># Initialize reverse complement as reverse of sequence</span>
        <span class="n">rev_comp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="o">.</span><span class="n">upper</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># Replace bases with complement</span>
        <span class="n">rev_comp</span> <span class="o">=</span> <span class="n">rev_comp</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">)</span>
        <span class="n">rev_comp</span> <span class="o">=</span> <span class="n">rev_comp</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
        <span class="n">rev_comp</span> <span class="o">=</span> <span class="n">rev_comp</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">)</span>
        <span class="n">rev_comp</span> <span class="o">=</span> <span class="n">rev_comp</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">rev_comp</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>We now need to update the <code class="docutils literal notranslate"><span class="pre">Primer</span></code> class to compute the reverse primer. We already wrote most of the code to do this, so we just need to tweak the class a bit.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">class</span> <span class="nc">Primer</span><span class="p">(</span><span class="n">Nucleotides</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Primer design.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">forward_and_reverse_marmur_primers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tm</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Forward and reverse primer design using Marmur rule</span>
<span class="sd">        of thum for melting temperature.</span>

<span class="sd">        `Tm`: the desired melting temperature in deg. C of the</span>
<span class="sd">              primer-template duplex.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Compute forward primer</span>
        <span class="n">forward_p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">marmur_primer</span><span class="p">(</span><span class="n">Tm</span><span class="p">)</span>

        <span class="c1"># Compute reverse complement of strand</span>
        <span class="n">rev_comp</span> <span class="o">=</span> <span class="n">Primer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reverse_complement</span><span class="p">())</span>

        <span class="c1"># Compute reverse primer</span>
        <span class="n">reverse_p</span> <span class="o">=</span> <span class="n">rev_comp</span><span class="o">.</span><span class="n">marmur_primer</span><span class="p">(</span><span class="n">Tm</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">forward_p</span><span class="p">,</span> <span class="n">reverse_p</span>


    <span class="k">def</span> <span class="nf">marmur_primer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tm</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Primer design based on Marmur rule of thumb for melting</span>
<span class="sd">        temperature.</span>

<span class="sd">        `Tm`: the desired melting temperature in deg. C of the</span>
<span class="sd">              primer-template duplex.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Start with a short primer of 10 nucleotides</span>
        <span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>

        <span class="c1"># Start at 5&#39; end with forward primer</span>
        <span class="n">forward_p</span> <span class="o">=</span> <span class="n">Nucleotides</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="p">[:</span><span class="n">n</span><span class="p">])</span>

        <span class="c1"># Keep adding based to the primer until we hit the desired Tm</span>
        <span class="k">while</span> <span class="n">forward_p</span><span class="o">.</span><span class="n">T_marmur</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">Tm</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="p">):</span>
            <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">forward_p</span><span class="o">.</span><span class="n">seq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="p">[:</span><span class="n">n</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">forward_p</span><span class="o">.</span><span class="n">seq</span>
</pre></div>
</div>
</div>
<p>Let’s go through each line of the method <code class="docutils literal notranslate"><span class="pre">forward_and_reverse_marmur_primers()</span></code>. First, we just compute the forward primer using the method we already wrote. Note that because we are in a method within the class definition, we need to use <code class="docutils literal notranslate"><span class="pre">self</span></code>, i.e., <code class="docutils literal notranslate"><span class="pre">self.marmum_primer(Tm)</span></code>. Next, we instantiate a new <code class="docutils literal notranslate"><span class="pre">Primer</span></code> instance that has the reverse complement of the strand of interest as its sequence. We then compute the forward primer of that (which is the reverse complement of our input
sequence). We then return both primers.</p>
<p>Let’s give it a whirl!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Instantiate sequence</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">Primer</span><span class="p">(</span><span class="s1">&#39;AACCCCCCAAATTTTTTTTTTGAAAAAAAAAACATATTCTTCTCTCGGGGGGGGG&#39;</span><span class="p">)</span>

<span class="c1"># Compute primers</span>
<span class="n">s</span><span class="o">.</span><span class="n">forward_and_reverse_marmur_primers</span><span class="p">(</span><span class="n">Tm</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(&#39;AACCCCCCAAATTTT&#39;, &#39;CCCCCCCCCGA&#39;)
</pre></div></div>
</div>
<p>This works, that’s great! Notice that we tried to reuse code we already wrote as much as possible. This is part of the <strong>DRY</strong> principle. It also is a great help in debugging.</p>
</div>
</div>
<div class="section" id="Protein-sequences">
<h2>Protein sequences<a class="headerlink" href="#Protein-sequences" title="Permalink to this headline">¶</a></h2>
<p>In keeping with the <strong>DRY</strong> principle, we can recycle the <code class="docutils literal notranslate"><span class="pre">Biosequence</span></code> class to handle protein sequences. We’ll make a new class with that computes the net charge of residues in a protein (assuming histidine is not charged).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">class</span> <span class="nc">Protein</span><span class="p">(</span><span class="n">Biosequence</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Protein sequences.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">netcharge</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compute the net charge of a protein&quot;&quot;&quot;</span>
        <span class="n">sequence</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="n">sequence</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;K&quot;</span><span class="p">)</span>
            <span class="o">+</span> <span class="n">sequence</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">)</span>
            <span class="o">-</span> <span class="n">sequence</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;E&quot;</span><span class="p">)</span>
            <span class="o">-</span> <span class="n">sequence</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;D&quot;</span><span class="p">)</span>
        <span class="p">)</span>
</pre></div>
</div>
</div>
<p>Again, we inherit all of the methods from the <code class="docutils literal notranslate"><span class="pre">Biosequence</span></code> class. We can instantiate and compute net charges.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Specify the sequence</span>
<span class="n">seq</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;MKKILLSVLTAFVAVVLAACGGNSDSKTLNSLDKIKQ&quot;</span>
    <span class="o">+</span> <span class="s2">&quot;NGVVRIGVFGDKPPFGYVDEKGNNQGYDIALAKRIAK&quot;</span>
    <span class="o">+</span> <span class="s2">&quot;ELFGDENKVQFVLVEAANRVEFLKSNKVDIILANFTQ&quot;</span>
    <span class="o">+</span> <span class="s2">&quot;TPQRAEQVDFCSPYMKVALGVAVPKDSNITSVEDLKD&quot;</span>
    <span class="o">+</span> <span class="s2">&quot;KTLLLNKGTTADAYFTQNYPNIKTLKYDQNTETFAAL&quot;</span>
    <span class="o">+</span> <span class="s2">&quot;MDKRGDALSHDNTLLFAWVKDHPDFKMGIKELGNKDV&quot;</span>
    <span class="o">+</span> <span class="s2">&quot;IAPAVKKGDKELKEFIDNLIIKLGQEQFFHKAYDETL&quot;</span>
    <span class="o">+</span> <span class="s2">&quot;KAHFGDDVKADDVVIEGGKI&quot;</span>
<span class="p">)</span>

<span class="c1"># Instantiate</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">Protein</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>

<span class="c1"># Compute net charge</span>
<span class="n">p</span><span class="o">.</span><span class="n">netcharge</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
-2
</pre></div></div>
</div>
</div>
<div class="section" id="Computing-environment">
<h2>Computing environment<a class="headerlink" href="#Computing-environment" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">load_ext</span> watermark
<span class="o">%</span><span class="k">watermark</span> -v -p jupyterlab
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Python implementation: CPython
Python version       : 3.8.10
IPython version      : 7.22.0

jupyterlab: 3.0.14

</pre></div></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="l37_algorithmic_complexity.html" class="btn btn-neutral float-right" title="Lesson 37: Algorithmic complexity" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="l35_regular_expressions.html" class="btn btn-neutral float-left" title="Lesson 35: Regular expressions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
      <span class="lastupdated">
        Last updated on Jul 01, 2021.
      </span>

    </p>
  </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-65442910-1', 'auto');
    
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>